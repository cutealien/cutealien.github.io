HTML_MOBILE_MENU = `
<div class="menu-mobile" data-menu="menu-mobile">
    <div class="menu-mobile__bg" data-menu-bg="menu-mobile"></div>
    <div class="menu-mobile__content" data-menu-content="menu-mobile">
        <div class="menu-mobile__header">
            <h3 class="header-tertiary">Cálculo 2</h3>
            <button class="menu-mobile-btn burger-btn" data-menu-btn="menu-mobile"><span class="burger-icon burger-icon--pressed"></span></button>
        </div>
        <nav class="navbar-mobile">
            <ol class="subject-list">
                <li class="subject-list__item">
                    <strong class="subject-list__title">1 La integral definida</strong>
                    <ol class="subject-list">
                        <li class="subject-list__item"><a href="./1.1-introduccion.html" class="subject-list__link">1.1 Introducción</a></li>
                        <li class="subject-list__item">
                            <a href="./1.2-Sumatoria.html" class="subject-list__link">1.2 El símbolo $\\sum$</a>
                            <ol class="subject-list">
                                <li class="subject-list__item"><a href="./1.2-Sumatoria.html#1.2" class="subject-list__link">1.2.1 Formalizando el símbolo sumatorio</a></li>
                                <li class="subject-list__item"><a href="./1.2.2-propiedades.html" class="subject-list__link">1.2.2 Propiedades del símbolo $\\sum$</a></li>
                            </ol>
                        </li>
                        <li class="subject-list__item"><a href="./1.3-calculo-de-areas.html" class="subject-list__link">1.3 Cálculo de  ́areas con rect. insc. y circuns.</a></li>
                        <li class="subject-list__item">
                            <a href="./1.4-integral-definida.html" class="subject-list__link">1.4 Construcción de la integral definida</a>
                            <ol class="subject-list">
                                <li class="subject-list__item"><a href="./1.4.1-integral-definida.html" class="subject-list__link">1.4.1 Construcción de la integral definida parte 2</a></li>
                                <li class="subject-list__item"><a href="./1.4.2-integral-definida.html" class="subject-list__link">1.4.2 Construcción de la integral definida parte 3</a></li>
                                <li class="subject-list__item"><a href="./1.4.3-integral-definida.html" class="subject-list__link">1.4.3 Construcción de la integral definida parte 4</a></li>
                                <li class="subject-list__item"><a href="./1.4.4-integral-definida.html" class="subject-list__link">1.4.4 Construcción de la integral definida parte 5</a></li>
                            </ol>
                        </li>
                        <li class="subject-list__item"><a href="./1.5-sumas-riemann.html" class="subject-list__link">1.5 Sumas de Riemann</a></li>
                        <li class="subject-list__item"><a href="./1.6-teorema-fundamental.html" class="subject-list__link">1.6 Teorema fundamental del Cálculo y sus consecuencias</a></li>
                    </ol>
                </li>
                <li class="subject-list__item">
                    <strong class="subject-list__title">2 La integral indefinida</strong>
                    <ol class="subject-list">
                        <li class="subject-list__item"><a href="./2.1-introduccion.html" class="subject-list__link">2.1 Introducción</a></li>
                        <li class="subject-list__item"><a href="./2.2-antiderivadas-inmediatas.html" class="subject-list__link">2.2 Antiderivadas inmediatas</a></li>
                        <li class="subject-list__item">
                            <a href="./2.3-metodo-sustitucion.html" class="subject-list__link">2.3 Método de int. por sust. o cambio de variable</a>
                            <ol class="subject-list">
                                <li class="subject-list__item"><a href="./2.3.1-metodo-sustitucion-parte-2.html" class="subject-list__link">2.3.1 Método de int. por sust. o cambio de variable parte 2</a></li>
                            </ol>
                        </li>
                        <li class="subject-list__item"><a href="./2.4-integracion-por-partes.html" class="subject-list__link">2.4 Método de integración por partes</a></li>
                        <li class="subject-list__item">
                            <a href="./2.5-fracciones-parciales.html" class="subject-list__link">2.5 Método de integración por fracciones parciales</a>
                            <ol class="subject-list">
                                <li class="subject-list__item"><a href="./2.5.1-factores-lineales-no-repetidos.html" class="subject-list__link">2.5.1 El polinomio $Q(x)$ solo contiene factores lineales que no se repiten</a></li>     
                                <li class="subject-list__item"><a href="./2.5.2-factores-lineales-repetidos.html" class="subject-list__link">2.5.2 El polinomio $Q(x)$ solo contiene factores lineales, pero algunos de ellos se repetidos</a></li>     
                                <li class="subject-list__item"><a href="./2.5.3-factores-cuadraticos-irreducibles.html" class="subject-list__link">2.5.3 Integrales de funciones simples que involucran términos cuadráticos irreducibles</a></li>     
                                <li class="subject-list__item"><a href="./2.5.4-factores-cuadraticos-no-repetidos.html" class="subject-list__link">2.5.4 El polinomio $Q(x)$ contiene factores cuadráticos irreducibles que no se repiten</a></li>     
                                <li class="subject-list__item"><a href="./2.5.5-factores-cuadraticos-repetidos.html" class="subject-list__link">2.5.5 El polinomio $Q(x)$ contiene factores cuadráticos irreducibles que se repiten</a></li>     
                            </ol>
                        </li>
                        <li class="subject-list__item"><a href="./2.6-sust-trigonometrica.html" class="subject-list__link subject-list__link--active">2.6 Met. de int. por sust. trigonométrica</a></li>     
                    </ol>
                </li>
                <li class="subject-list__item">
                    <strong class="subject-list__title">3 Integrales impropias y aplicaciones</strong>
                    <ol class="subject-list">
                        <li class="subject-list__item"><a href="./3.1-integrales-impropias.html" class="subject-list__link">3.1 Integrales impropias</a></li>
                        <li class="subject-list__item"><a href="./3.2-mas-integrales-impropias.html" class="subject-list__link">3.2 Más integrales impropias (para funciones discontinuas)</a></li>
                        <li class="subject-list__item"><a href="./3.3-calculo-de-areas.html" class="subject-list__link">3.3 Cálculo de áreas de regiones acotadas por curvas</a></li>   
                        <li class="subject-list__item"><a href="./3.4-calculo-de-volumenes.html" class="subject-list__link">3.4 Cálculo de volúmenes</a></li>   
                        <li class="subject-list__item"><a href="./3.5-mas-calculo-de-volumenes.html" class="subject-list__link">3.5 Más cálculos de volúmenes</a></li>   
                        <li class="subject-list__item"><a href="./3.6-longitud-arco.html" class="subject-list__link">3.6 Longitud de arco y áreas de superficies de revolución</a></li>   
                    </ol>
                </li>
                <li class="subject-list__item">
                        <strong class="subject-list__title">4 Series y Sucesiones</strong>
                        <ol class="subject-list">
                            <li class="subject-list__item"><a href="./4.1-sucesiones.html" class="subject-list__link">4.1 Sucesiones</a></li>
                            <li class="subject-list__item"><a href="./4.2-algebra-de-sucesiones.html" class="subject-list__link">4.2 Álgebra de sucesiones</a></li>
                            <li class="subject-list__item"><a href="./4.3-ejemplos-de-sucesiones.html" class="subject-list__link">4.3 Más ejemplos de sucesiones</a></li>
                            <li class="subject-list__item"><a href="./4.4-series.html" class="subject-list__link">4.4 Series</a></li>
                            <li class="subject-list__item"><a href="./4.5-criterios-de-convergencia.html" class="subject-list__link">4.5 Criterios de convergencia</a></li>
                            <li class="subject-list__item"><a href="./4.6-convergencia-absoluta-condicional.html" class="subject-list__link">4.6 Más ejemplos de series</a></li>
                            <li class="subject-list__item"><a href="./4.7-series-potencias.html" class="subject-list__link">4.7 Series de potencias</a></li>
                            <li class="subject-list__item"><a href="./4.8-series-taylor-mclaurin.html" class="subject-list__link">4.8 Series de Taylor y McLaurin</a></li>
                        </ol>
                    </li>
                <li class="subject-list__item">
                    <strong class="subject-list__title">Anexo</strong>
                    <ol class="subject-list">
                        <li class="subject-list__item"><a href="./anexo-conjuntos.html" class="subject-list__link">Conjuntos</a></li>
                        <li class="subject-list__item"><a href="./anexo-demostracion-teo-1.5.1.html" class="subject-list__link">Demostración Teorema 1.5.1</a></li> 
                        <li class="subject-list__item"><a href="./anexo-demostracion-teo-1.5.3.html" class="subject-list__link">Demostración Teorema 1.5.3</a></li>
                        <li class="subject-list__item"><a href="./references.html" class="subject-list__link">Referencias</a></li> 
                    </ol>
                </li>
            </ol>
        </nav>
    </div>
</div>`

class AlienMobileSidebar extends HTMLElement {
    constructor() {
        super()
    }

    async connectedCallback() {
        let path = `./components/mobile-sidebar/mobile-sidebar.html`

        this.#getHTML(path)
    }

    async #getHTML(path) {

        let text = HTML_MOBILE_MENU

        await typeset(() => {
            const mobileMenu = document.querySelector('#mobile-menu');
            mobileMenu.innerHTML = text;
            return [mobileMenu];
        });

        let currentPath = window.location.pathname.split('/').slice(-1)
        let link = this.querySelector(`a[href='./${currentPath}']`)
        link.classList.add('subject-list__link--active')

        this.menuInitialize()
    }

    menuInitialize = () => {
        const menuMobilebtns = document.querySelectorAll('[data-menu-btn=menu-mobile]')
        const menuMobile = document.querySelector('[data-menu=menu-mobile]')
        const menuMobilebg = document.querySelector('[data-menu-bg=menu-mobile]')
        const menuMobilecontent = document.querySelector('[data-menu-content=menu-mobile]')

        menuMobilebtns.forEach(btn => {
            btn.addEventListener('click', toggleMenu)
        })

        menuMobilebg.addEventListener('click', toggleMenu)

        menuMobile.addEventListener('transitionend', (e) => {
            // console.log(e)
            if (menuMobile.classList.contains('menu-mobile--active')) {
                menuMobile.classList.add('menu-mobile--visible')
            }
            else {
                menuMobile.classList.remove('menu-mobile--visible')
            }
        })

        function toggleMenu() {
            menuMobile.classList.toggle('menu-mobile--active')
            menuMobilebg.classList.toggle('menu-mobile__bg--active')
            menuMobilecontent.classList.toggle('menu-mobile__content--active')
        }

        window.addEventListener("resize", (e) => {
            let media = window.matchMedia('(min-width: 1000px) and (max-width: 1280px) and (orientation: landscape)')
            if (media.matches) {
                menuMobile.classList.remove('menu-mobile--visible')
                menuMobile.classList.remove('menu-mobile--active')
                menuMobilebg.classList.remove('menu-mobile__bg--active')
                menuMobilecontent.classList.remove('menu-mobile__content--active')
            }
        });
    }
}

customElements.define("alien-mobile-sidebar", AlienMobileSidebar);